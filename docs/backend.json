{
  "entities": {
    "User": {
      "title": "User Profile",
      "description": "Represents a user's public profile information, created upon first login.",
      "type": "object",
      "properties": {
        "displayName": {
          "type": "string",
          "description": "The user's display name."
        },
        "email": {
          "type": "string",
          "format": "email",
          "description": "The user's email address."
        },
        "photoURL": {
          "type": "string",
          "format": "uri",
          "description": "URL of the user's profile picture."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp when the user account was created."
        }
      },
      "required": ["displayName", "email", "createdAt"]
    },
    "Budget": {
      "title": "Budget",
      "description": "Represents a single budget, which can be personal or shared.",
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the budget."
        },
        "ownerId": {
          "type": "string",
          "description": "The UID of the user who owns and created the budget."
        },
        "members": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "An array of user UIDs who have read/write access to this budget. Includes the owner by default."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp when the budget was created."
        },
        "join_code": {
            "type": "string",
            "description": "A unique, short code to join this budget."
        },
        "mode": {
            "type": "string",
            "enum": ["tracking", "sharing"],
            "description": "The mode of the budget, either for personal tracking or for sharing expenses."
        }
      },
      "required": ["name", "ownerId", "members", "createdAt", "mode"]
    },
    "Transaction": {
      "title": "Transaction",
      "description": "Represents a single financial transaction within a budget.",
      "type": "object",
      "properties": {
        "amount": {
          "type": "number",
          "description": "The amount of the transaction."
        },
        "type": {
          "type": "string",
          "enum": ["income", "expense"],
          "description": "The type of transaction."
        },
        "category": {
          "type": "string",
          "description": "The category of the transaction."
        },
        "date": {
          "type": "string",
          "format": "date-time",
          "description": "The date and time of the transaction."
        },
        "note": {
          "type": "string",
          "description": "An optional note for the transaction."
        },
        "authorId": {
          "type": "string",
          "description": "The UID of the user who created the transaction. Must be one of the budget's members."
        },
        "payer_id": {
            "type": "string",
            "description": "The UID of the user who paid for the transaction. Null if it's a common transaction."
        }
      },
      "required": ["amount", "type", "category", "date", "authorId"]
    },
    "TransactionParticipant": {
      "title": "Transaction Participant",
      "description": "Links a user to a transaction they participated in, used for splitting costs.",
      "type": "object",
      "properties": {
        "transaction_id": {
          "type": "string",
          "description": "The ID of the transaction."
        },
        "user_id": {
          "type": "string",
          "description": "The ID of the user who participated."
        }
      },
      "required": ["transaction_id", "user_id"]
    }
  },
  "auth": {
    "providers": ["google.com", "email"]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": {
        "$ref": "#/entities/User"
      },
      "description": "Stores public user profile data, keyed by user UID. A user can only read/write their own document."
    },
    "/budgets/{budgetId}": {
      "schema": {
        "$ref": "#/entities/Budget"
      },
      "description": "Main collection for all budgets. Security rules will enforce that only users whose UID is in the 'members' array can read/write."
    },
    "/budgets/{budgetId}/transactions/{transactionId}": {
      "schema": {
        "$ref": "#/entities/Transaction"
      },
      "description": "Sub-collection for transactions within a specific budget. Access is inherited from the parent budget; only budget members can read/write transactions."
    },
    "/budgets/{budgetId}/transactions/{transactionId}/participants/{userId}": {
        "schema": {
            "$ref": "#/entities/TransactionParticipant"
        },
        "description": "Links a user to a transaction they participated in."
    }
  }
}
